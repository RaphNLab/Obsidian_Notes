
# STM32 Clock Configuration
This note contains information about configuring the clock of STM32 microcontrollers.
There are 3 different clock sources to drive the system clock (SYSCLK):
* High speed internal oscillator (HSI)
* High speed external oscillator(HSE) 
* Phase-locked loop clock (PLL)*

![[Pasted image 20240618170502.png]]

In the following sections we will discuss in details about the different cloack sources
## HSI
The HSI is the internal default RC oscillator clock source and can be used as system clock. As shown in the figure the HSI can be devided by 2 before been used as PLL source. The maximum system clock frequency while using the HSI as clock source is 32MHz.

The HSI has several advantages  as:
* Provide low cost clock source (No external component needed)
* Faster startup time
The HSI has also some disadvantages related to the accuracy of the generated frequency in comparison with external crystal oscillator or ceramic resonator.
## HSE
The HSE is mostly generated by an external ceramic oscillator due the fact that it produce a vary accurate rate on the main clock. At startup the clock is not  released if the `HSERDY` flag is not set by the hardware in the `RCC_CR` (RCC Control register) register. This bit indicate if the oscillator is stable or not. An interrupt can be generated if enabled in teh `RCC_CIR` (RCC Clock interrupt register) register. To turn on and off the the HSE oscillator the `HSEON` bit of the `RCC_CR` register can be used. The following picture shows an overview of the hardware.

![[Pasted image 20240621135804.png]]

## PLL

Sometimes we may need more speed than the one generated by the HSI and HSE, this is where the PLL comes in action. It can be used to multiply  the clock frequency of both HSI and HSE output. Before activating the PLL, the configuration must be done (Selecting the PLL input clock (Here HSI/2 or HSE) and multiplication factor) otherwise the parameters can not be changed once it is started.
 